{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,0BCAAC,EAAAD,EAAA,SAEO,SAASE,EAAaC,GAC3B,IAAMC,EAASD,EACZE,KACC,SAAAC,G,IACEC,EAAYD,EAAZC,aACAC,EAAaF,EAAbE,cACAC,EAAIH,EAAJG,KACAC,EAAKJ,EAALI,MACAC,EAAKL,EAALK,MACAC,EAAQN,EAARM,SACAC,EAASP,EAATO,UAEA,MAAO,wCAGSC,OAFaN,EAAc,kEAELM,OAAtBP,EAAa,WAGNO,OAHeL,EAAK,2HAMpBK,OAHAJ,EAAM,4FAMHI,OAHHH,EAAM,+FAMFG,OAHDF,EAAS,gGAGEE,OAAVD,EAAU,qF,IAQxCE,KAAK,IAERd,EAAAe,KAAKC,QAAQC,mBAAmB,YAAad,E,+BD/B/CH,EAAAe,KAAKG,KAAKC,iBAAiB,UAmE3B,SAAsBC,GACpBA,EAAMC,iBAEN,IAAMC,EAAaF,EAAMG,OAAOC,SAASC,YAAYC,MAErD,IAAKJ,EAAWK,QAAUL,IAAeM,EACvC,OAAOC,EAAAC,OAAOC,QAAQ,oCAExBH,EAAcN,EACdU,EAAa,EAEbhC,EAAAe,KAAKC,QAAQiB,UAAY,GAEzBC,EAAUN,EAAaI,GAEvBhC,EAAAe,KAAKG,KAAKiB,O,IAhFZ,IACIH,EADAJ,EAAc,GAQZQ,EAAW,IAAIC,sBACnB,SAAAC,GACEA,EAAQC,SAAQ,SAAAC,GACVA,EAAMC,iBACRC,QAAQC,IAAIH,GACZN,EAAUN,EAAaI,G,MAI7B,CACEY,KAAM,KACNC,WAAY,QACZC,UAAW,I,SAIAZ,EAAUa,EAAGC,G,OAAbC,EAASC,MAAAC,KAAAC,U,UAATH,I,OAAAA,EAAfI,EAAAvD,EAAA,CAAAuD,EAAAC,GAAAC,MAAA,SAAAC,EAAyBT,EAAGC,G,IAElBS,EAiBAC,E,4FAjBa,EAAAC,EAAAC,kBAAiBb,EAAGC,G,UAAjCS,EAAII,EAAAC,KACVpB,QAAQC,IAAIc,EAAKM,MACjBrB,QAAQC,IAAIc,GAEPA,EAAKO,UAAS,C,sBACjBnC,EAAAC,OAAOmC,QACL,4E,6BAKJhE,EAAawD,EAAKM,MAEC,IAAf/B,GACFH,EAAAC,OAAOoC,QAAQ,oBAAmCrD,OAAf4C,EAAKO,UAAU,aAG9CN,EAAWS,KAAKC,KAAKX,EAAKO,UAAY,IAExChC,IAAe0B,EAAQ,C,uBAEvBtB,EAASiC,UAAUrE,EAAAe,KAAKuD,OACxBzC,EAAAC,OAAOyC,KACJ,8D,2BAMPvC,GAAc,EACdI,EAASoC,QAAQxE,EAAAe,KAAKuD,O,kDAItB5B,QAAQC,IAAGkB,EAAAY,IACX5C,EAAAC,OAAOmC,QAAS,qD,2DArCIf,MAAAC,KAAAC,U","sources":["src/js/02-scroll.js","src/js/02-markup.js"],"sourcesContent":["import { fetchPixabayData } from './pixabay-api';\nimport { createMarkup } from './02-markup';\nimport { refs } from './refs';\n\nimport { Notify } from 'notiflix';\n// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n\nrefs.form.addEventListener('submit', onFormSubmit);\n\nlet searchQuery = '';\nlet searchPage;\n\n// lightbox = new SimpleLightbox('.gallery a', {\n//   overlayOpacity: 0.5,\n//   captionDelay: 250,\n// });\n\nconst observer = new IntersectionObserver(\n  entries => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        console.log(entry);\n        getImages(searchQuery, searchPage);\n      }\n    });\n  },\n  {\n    root: null,\n    rootMargin: '100px',\n    threshold: 1.0,\n  }\n);\n\nasync function getImages(q, pages) {\n  try {\n    const data = await fetchPixabayData(q, pages);\n    console.log(data.hits);\n    console.log(data);\n\n    if (!data.totalHits) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n      return;\n    }\n\n    createMarkup(data.hits);\n\n    if (searchPage === 1) {\n      Notify.success(`Hooray! We found ${data.totalHits} images.`);\n    }\n\n    const lastPage = Math.ceil(data.totalHits / 40);\n\n    if (searchPage === lastPage) {\n      {\n        observer.unobserve(refs.guard);\n        Notify.info(\n          `We're sorry, but you've reached the end of search results.`\n        );\n        return;\n      }\n    }\n\n    searchPage += 1;\n    observer.observe(refs.guard);\n\n    // lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    Notify.failure(`Ooops... Something goes wrong. Please, try again.`);\n  }\n}\n\nfunction onFormSubmit(event) {\n  event.preventDefault();\n\n  const inputValue = event.target.elements.searchQuery.value;\n\n  if (!inputValue.trim() || inputValue === searchQuery)\n    return Notify.warning('Please enter something to search');\n\n  searchQuery = inputValue;\n  searchPage = 1;\n\n  refs.gallery.innerHTML = '';\n\n  getImages(searchQuery, searchPage);\n\n  refs.form.reset();\n}\n","import { refs } from './refs';\n\nexport function createMarkup(array) {\n  const markup = array\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <a class=\"link-card\" href=\"${largeImageURL}\">\n          <div class=\"photo-card\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n              <p class=\"info-item\">\n                <b>Likes</b> ${likes}\n              </p>\n              <p class=\"info-item\">\n                <b>Views</b> ${views}\n              </p>\n              <p class=\"info-item\">\n                <b>Comments</b> ${comments}\n              </p>\n              <p class=\"info-item\">\n                <b>Downloads</b> ${downloads}\n              </p>\n            </div>\n          </div>\n        </a>\n        `;\n      }\n    )\n    .join('');\n\n  refs.gallery.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["$bpxeT","parcelRequire","$4Nugj","$6b801f2164daa4d7$export$24783e9f3a24abe4","array","markup","map","param","webformatURL","largeImageURL","tags","likes","views","comments","downloads","concat","join","refs","gallery","insertAdjacentHTML","form","addEventListener","event","preventDefault","inputValue","target","elements","searchQuery","value","trim","$90b5ba0196ef99e0$var$searchQuery","$6JpON","Notify","warning","$90b5ba0196ef99e0$var$searchPage","innerHTML","$90b5ba0196ef99e0$var$getImages","reset","$90b5ba0196ef99e0$var$observer","IntersectionObserver","entries","forEach","entry","isIntersecting","console","log","root","rootMargin","threshold","q","pages","$90b5ba0196ef99e0$var$_getImages","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","data","lastPage","$8H72y","fetchPixabayData","_ctx","sent","hits","totalHits","failure","success","Math","ceil","unobserve","guard","info","observe","t0"],"version":3,"file":"02-scroll.d9ea421d.js.map"}